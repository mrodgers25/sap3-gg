<div class="container-fluid">
  <div class="jumbotron bg-white admin-stories admin-index-page">
    <div class="header text-center">
      <h4><i class="fas fa-list mr-1"></i> Workable Stories</h4>
    </div>

    <hr class="mt-3 mb-2">

    <%= form_tag(admin_workable_stories_path, method: :get) do %>
      <div class="row filters">
        <div class="col-12 col-sm-6 col-md-3 mt-1 mt-md-0">
          <%= text_field_tag :url_title, params[:url_title], placeholder: 'Search Title...', maxlength: 100, size: 100, class: "form-control form-control-sm search-field" %>
        </div>
        <div class="col-12 col-sm-6 col-md-3 mt-1 mt-md-0">
          <%=
            select_tag :state,
            options_from_collection_for_select(Story.all_states, 'to_s', 'titleize', params[:state]),
            prompt: 'All Story Status',
            class: 'form-control form-control-sm',
            id: 'state-select'
          %>
        </div>
        <div class="col-12 col-sm-6 col-md-3 mt-1 mt-md-0">
          <%=
            select_tag :type,
            options_from_collection_for_select(Story.all_types, 'to_s', 'to_s', params[:type]),
            prompt: 'All Types',
            class: 'form-control form-control-sm',
            id: 'type-select'
          %>
        </div>
        <div class="col-12 col-sm-6 col-md-3 mt-1 mt-md-0">
          <%= submit_tag "Filter", class: 'btn btn-sm btn-secondary' %>
        </div>
      </div>
    <% end %>

    <hr class="mt-2 mb-3">

    <div class="table-div">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Title</th>
            <th scope="col">Story Date</th>
            <th scope="col">State</th>
            <th scope="col">Progress</th>
            <th scope="col">Assigned To</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @stories.each do |story| %>
            <tr>
              <td><%= story.id %></td>
              <td style="width: 300px"><%= link_to story.display_title, admin_story_path(story.id), target: '_blank', class: 'text-dark' %></td>
              <td><%= story.story_display_date || '-' %></td>
              <td style="width: 150px">
                <i class='fa fa-circle fa-xs <%= story_state_color(story.state) %>'></i> <%= story&.state.titleize || '-' %>
              </td>
              <td>
                <%= '-' %>
              </td>
              <td style="width: 150px">
                <%= '-' %>
              </td>
              <td style="width: 200px;">
              <% if story.workable? %>
                <%= link_to edit_admin_story_path_helper(story), class: "btn btn-sm btn-outline-warning", data: { toggle: 'tooltip', placement: 'top', title: 'Edit story', turbolinks: false } do %>
                  <i class="fas fa-edit"></i>
                <% end %>
              <% else %>
                <%= link_to admin_story_path(story), class: "btn btn-sm btn-outline-primary", target: '_blank', data: { toggle: 'tooltip', placement: 'top', title: 'View story page' } do %>
                  <i class="fas fa-search"></i>
                <% end %>
              <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <hr class="my-2">

    <div class='pagination'>
      <%== pagy_bootstrap_nav(@pagy) %>
    </div>
  </div>
</div>
